{% extends 'base.html' %}
{% block title %}{{ test.title }}{% endblock %}
{% block content %}
<div class="max-w-3xl mx-auto bg-white p-8 rounded-2xl shadow">
  <div class="flex items-center justify-between mb-4 gap-2 flex-wrap">
    <div>
      <h2 class="text-2xl font-bold">{{ test.title }}</h2>
      <div class="mb-2 text-gray-500">{{ test.description or "—" }}</div>
    </div>
    <div class="flex gap-2 flex-wrap">
      <a href="{{ url_for('tests.add_question', test_id=test.id) }}"
         class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-semibold shadow">+ Добавить вопрос</a>
      <a href="{{ url_for('tests.edit_test', test_id=test.id) }}"
         class="bg-yellow-100 text-yellow-900 px-4 py-2 rounded-lg font-semibold shadow hover:bg-yellow-200">Редактировать тест</a>
      <form method="post" action="{{ url_for('tests.delete_test', test_id=test.id) }}" style="display:inline" onsubmit="return confirm('Удалить тест и все вопросы?');">
        <button type="submit" class="bg-red-100 text-red-900 px-4 py-2 rounded-lg font-semibold shadow hover:bg-red-200">Удалить тест</button>
      </form>
    </div>
  </div>
  {% if test.questions %}
    <ol class="space-y-5 mt-6">
      {% for q in test.questions %}
        <li class="bg-gray-50 p-4 rounded-lg shadow-inner group relative">
          <div class="mb-2 font-semibold flex items-center gap-2">
            <span>{{ loop.index }}. {{ q.text }}</span>
            <a href="{{ url_for('tests.edit_question', question_id=q.id) }}"
               class="text-blue-600 text-xs px-2 py-1 rounded hover:bg-blue-50 ml-2">Редактировать</a>
            <form method="post" action="{{ url_for('tests.delete_question', question_id=q.id) }}"
                  style="display:inline" onsubmit="return confirm('Удалить этот вопрос?');">
              <button type="submit" class="text-red-600 text-xs px-2 py-1 rounded hover:bg-red-50 ml-2">Удалить</button>
            </form>
          </div>
          <ul>
            {% for a in q.answers %}
              <li class="flex items-center gap-2 {% if a.is_correct %}font-bold text-green-700{% endif %}">
                <span class="rounded-full w-2.5 h-2.5 inline-block {% if a.is_correct %}bg-green-400{% else %}bg-gray-400{% endif %}"></span>
                {{ a.text }} <span class="ml-2 text-xs text-blue-700">({{ a.score }} бал.)</span>
                {% if a.is_correct %}
                  <span class="ml-2 text-xs bg-green-200 text-green-900 px-2 py-0.5 rounded">правильный</span>
                {% endif %}
              </li>
            {% endfor %}
          </ul>
        </li>
      {% endfor %}
    </ol>
  {% else %}
    <div class="text-gray-400 text-center mt-10">Нет вопросов</div>
  {% endif %}
</div>
{% endblock %}
