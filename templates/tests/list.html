{% extends 'base.html' %}
{% block title %}Тесты{% endblock %}
{% block content %}
<div class="max-w-6xl mx-auto pt-10">
  <h1 class="text-4xl font-extrabold mb-10 flex items-center gap-3">
    <svg class="inline-block text-blue-500" width="38" height="38" fill="none" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="10" fill="#6366f1"/>
      <path d="M7 13.5L10.5 17L17 10" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    Тесты
  </h1>
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">

    {% for test in tests %}
      <div class="relative group flex flex-col bg-white/95 border border-gray-200 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-200 p-8 min-h-[240px] overflow-hidden">

        <!-- Иконка + Название -->
        <div class="flex items-center gap-3 mb-2">
          <div class="flex items-center justify-center w-12 h-12 rounded-xl bg-gradient-to-br from-blue-400 to-violet-500 shadow-inner">
            <svg width="28" height="28" fill="none" viewBox="0 0 24 24">
              <rect x="4" y="7" width="16" height="10" rx="2.5" fill="#fff" />
              <rect x="8" y="5" width="8" height="2" rx="1" fill="#c7d2fe" />
            </svg>
          </div>
          <span class="text-2xl font-bold tracking-tight">{{ test.title }}</span>
        </div>

        <!-- Описание -->
        <div class="text-gray-500 mb-6 text-base line-clamp-2">{{ test.description or '—' }}</div>

        <!-- Действия (видимы только при hover) -->
        <div class="absolute top-4 right-4 flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10">
          <a href="{{ url_for('tests.edit_test', test_id=test.id) }}"
             class="inline-flex items-center px-4 py-1.5 rounded-xl bg-blue-50 text-blue-700 text-xs font-semibold hover:bg-blue-100 shadow transition">Редактировать</a>
          <form method="post" action="{{ url_for('tests.delete_test', test_id=test.id) }}"
                onsubmit="return confirm('Удалить тест «{{ test.title }}»?')" class="inline">
            <button type="submit"
               class="inline-flex items-center px-4 py-1.5 rounded-xl bg-red-50 text-red-700 text-xs font-semibold hover:bg-red-100 shadow transition">Удалить</button>
          </form>
        </div>

        <!-- Ссылки внизу -->
        <div class="mt-auto flex gap-3 items-center pt-3">
          <a href="{{ url_for('tests.view_test', test_id=test.id) }}"
             class="flex items-center gap-1 text-blue-600 hover:text-violet-700 font-semibold transition">
            <span>Перейти</span>
            <svg width="18" height="18" fill="none" class="ml-1" viewBox="0 0 20 20"><path d="M7 15l5-5-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </a>
          {% if session.get('is_admin') %}
          <a href="{{ url_for('tests.test_results', test_id=test.id) }}"
             class="flex items-center gap-1 px-3 py-1.5 rounded-xl bg-green-50 text-green-700 text-xs font-semibold hover:bg-green-100 shadow transition">
            <svg width="16" height="16" fill="none" viewBox="0 0 24 24">
              <path d="M5 13l4 4L19 7" stroke="#059669" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Ответы
          </a>
          {% endif %}
        </div>
      </div>
    {% endfor %}

    <!-- Создать тест -->
    <a href="{{ url_for('tests.create_test') }}"
       class="flex flex-col items-center justify-center rounded-2xl shadow-lg bg-gradient-to-tr from-blue-500 to-violet-600 hover:from-blue-600 hover:to-violet-700 text-white font-extrabold text-3xl min-h-[240px] transition group border-2 border-dashed border-blue-200 hover:border-violet-300">
      <div class="mb-2 flex items-center justify-center w-16 h-16 rounded-full bg-white/10 text-4xl group-hover:bg-white/20 transition">+</div>
      <span class="mt-2 text-2xl">Создать тест</span>
    </a>
  </div>
</div>
{% endblock %}
